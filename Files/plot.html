<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module">
        import { TPolyLine3D, draw } from "https://root.cern/js/latest/modules/main.mjs";

        document.addEventListener("DOMContentLoaded", async function () {
            console.log("ðŸš€ Loading trajectory JSON data...");

            try {
                // Load JSON file from GitHub Pages (update the URL with your repo)
                let response = await fetch("../Files/plot.json");
                if (!response.ok) throw new Error("Failed to fetch JSON");

                let jsonData = await response.json();
                let trajectories = jsonData.trajectories; // Extract the list of trajectories

                if (!trajectories || trajectories.length === 0) {
                    throw new Error("No trajectory data found in JSON!");
                }

                // Create an array of TPolyLine3D objects
                let polylines = [];

                for (let i = 0; i < trajectories.length; i++) {
                    let polyline = new TPolyLine3D(2); // Each trajectory has 2 points (upstream â†’ downstream)

                    // Set the start (upstream) and end (downstream) points
                    polyline.SetPoint(0, trajectories[i].x_upstream, trajectories[i].y_upstream, trajectories[i].z_upstream);
                    polyline.SetPoint(1, trajectories[i].x_downstream, trajectories[i].y_downstream, trajectories[i].z_downstream);

                    polyline.fLineColor = (i % 9) + 1;  // Assign different colors
                    polyline.fLineWidth = 2;

                    polylines.push(polyline);
                }

                // Draw the 3D plot
                draw("plot", polylines, ""); 

                console.log("âœ… Successfully displayed interactive 3D beam trajectories!");
            } catch (error) {
                console.error("ðŸš¨ Error loading JSON:", error);
            }
        });
    </script>
</head>
<body>
    <p>Interactive 3D Beam Trajectory Visualization:</p>
    <div id="plot" style="width:800px; height:600px; border:2px solid red;"></div>
</body>
</html>
